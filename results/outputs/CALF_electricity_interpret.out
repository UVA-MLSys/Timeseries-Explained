
>>>> itr_no: 1, seed: 648 <<<<<<
Use GPU: cuda:0
model_id  ori
Experiments will be saved in ./results/electricity_CALF/1
test 2607
Loading model from ./results/electricity_CALF/1/checkpoint.pth

Running feature_ablation from 2024-11-30 12:18:45.503826
Experiment ended at 2024-11-30 12:37:22.519042. Total time taken 0:18:37.015216.
  metric   area       comp       suff
0    mae  0.050   9.140640  17.508822
1    mae  0.075  10.552035  16.625830
2    mae  0.100  11.232108  16.102248
3    mae  0.150  12.519889  14.930837
4    mse  0.050   7.525988  20.619081
5    mse  0.075   9.238782  18.775568
6    mse  0.100  10.169867  17.707886
7    mse  0.150  12.007346  15.378688


Running occlusion from 2024-11-30 12:37:22.769149
Experiment ended at 2024-11-30 12:55:57.598268. Total time taken 0:18:34.829119.
  metric   area       comp       suff
0    mae  0.050  11.165111  16.171956
1    mae  0.075  12.720087  14.797143
2    mae  0.100  13.478232  13.987442
3    mae  0.150  14.937376  12.225451
4    mse  0.050   9.897211  17.861078
5    mse  0.075  12.198424  15.140745
6    mse  0.100  13.427640  13.616276
7    mse  0.150  15.899144  10.548987


Running augmented_occlusion from 2024-11-30 12:55:57.821145
Experiment ended at 2024-11-30 13:14:48.655744. Total time taken 0:18:50.834599.
  metric   area       comp       suff
0    mae  0.050   7.971650  18.217020
1    mae  0.075   9.332975  17.384995
2    mae  0.100  10.038847  16.889594
3    mae  0.150  11.445272  15.737271
4    mse  0.050   6.148502  22.120330
5    mse  0.075   7.665615  20.257282
6    mse  0.100   8.547635  19.182259
7    mse  0.150  10.432541  16.808907


Running feature_permutation from 2024-11-30 13:14:48.882126
Experiment ended at 2024-11-30 13:33:32.847619. Total time taken 0:18:43.965493.
  metric   area       comp       suff
0    mae  0.050   6.011082  19.880852
1    mae  0.075   7.788888  19.160031
2    mae  0.100   8.737799  18.747803
3    mae  0.150  10.587056  17.866604
4    mse  0.050   3.740013  26.244240
5    mse  0.075   5.486620  24.497836
6    mse  0.100   6.583322  23.506541
7    mse  0.150   8.968784  21.456463


Running integrated_gradients from 2024-11-30 13:33:33.080955
Traceback (most recent call last):
  File "/u/mi3se/projects/SA-Timeseries/interpret_CALF.py", line 81, in <module>
  File "/u/mi3se/projects/SA-Timeseries/interpret_CALF.py", line 48, in main
    args.seeds = [int(seed) for seed in experiment_seeds]
  File "/u/mi3se/projects/SA-Timeseries/exp/exp_interpret.py", line 316, in interpret
    continue
  File "/u/mi3se/projects/SA-Timeseries/exp/exp_interpret.py", line 248, in run_regressor
    else: 
  File "/u/mi3se/projects/SA-Timeseries/exp/exp_interpret.py", line 353, in evaluate
    print()
  File "/u/mi3se/projects/SA-Timeseries/utils/explainer.py", line 285, in compute_attr
    attr = compute_attr_with_gradient(
  File "/u/mi3se/projects/SA-Timeseries/utils/explainer.py", line 228, in compute_attr_with_gradient
    else: attr = explainer.attribute(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/captum/log/__init__.py", line 42, in wrapper
    return func(*args, **kwargs)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/captum/attr/_core/integrated_gradients.py", line 286, in attribute
    attributions = self._attribute(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/captum/attr/_core/integrated_gradients.py", line 351, in _attribute
    grads = self.gradient_func(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/captum/_utils/gradient.py", line 112, in compute_gradients
    outputs = _run_forward(forward_fn, inputs, target_ind, additional_forward_args)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/captum/_utils/common.py", line 531, in _run_forward
    output = forward_func(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/u/mi3se/projects/SA-Timeseries/models/CALF.py", line 532, in forward
    output = self.forecast(x)
  File "/u/mi3se/projects/SA-Timeseries/models/CALF.py", line 279, in forecast
    outputs_time1,  outputs_text1 = self.in_layer(x)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/u/mi3se/projects/SA-Timeseries/models/CALF.py", line 49, in forward
    x, _ = self.cross_attention(q, k, v)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/modules/activation.py", line 1266, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/functional.py", line 5364, in multi_head_attention_forward
    q, k, v = _in_projection_packed(query, key, value, in_proj_weight, in_proj_bias)
  File "/u/mi3se/anaconda3/envs/ml/lib/python3.10/site-packages/torch/nn/functional.py", line 4896, in _in_projection_packed
    kv_proj = linear(k, w_kv, b_kv)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.58 GiB. GPU 
